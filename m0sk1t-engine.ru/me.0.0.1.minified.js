/**
 * @author m0sk1t
 */
(function(){if(window.me===undefined){window.me={};var e=["core","utils","primitive","assets","physics","input"];e.forEach(function(e){window.me[e]={}})}me.core.each=function(e,t){if(e instanceof Array)for(var n=0;n<e.length;n++)t.call(e,e[n]);else if(e instanceof Object)for(field in e)if(e.hasOwnProperty(field))t.call(e,e[field],field)};me.core.class=function(e){var t=e;if(e["parent"]!==undefined){var n=e["parent"];if(typeof n==="function"){me.core.each(n.prototype,function(e,n){if(t[e]===undefined){t[e]=n}else{t["parent_"+e]=n}})}}var r=e["init"];if(r===undefined){r=function(){if(this.prototype["parent_init"])this.parent_init()}}r.prototype=t;return r};me.core.canvas=[];me.core.layers=[];me.core.init=function(e,t,n){var r=me.utils.find(e);for(var i=0,s=r.length;i<s;i++){me.core.canvas[e[i]]=r[i];me.core.canvas[e[i]].width=t||document.width||document.documentElement.clientWidth;me.core.canvas[e[i]].height=n||document.height||document.documentElement.clientHeight;if(me.core.isCanvas(me.core.canvas[e[i]])){me.core.layers[e[i]]=me.core.canvas[e[i]].getContext("2d")}}};me.core.clear=function(e){me.core.canvas[e].width=me.core.canvas[e].width};me.core.isOut=function(e,t){return e.x<0||e.y<0||e.x>me.core.canvas[t].width||e.y>me.core.canvas[t].height};me.core.distance=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))};me.core.isCollide=function(e,t){var n=false;switch(e["type"]){case"circle":{switch(t["type"]){case"point":n=me.core.circleAndPointCollision(e,t);break;case"circle":n=me.core.circleCollision(e,t);break;case"rectangle":n=me.core.circleAndRectangleCollision(e,t);break}};case"rectangle":n=me.core.rectangleCollision(e,t);break}return n};me.core.circleCollision=function(e,t){return e.radius+t.radius>Math.sqrt(Math.pow(e.coord.x-t.coord.x,2)+Math.pow(e.coord.y-t.coord.y,2))};me.core.rectangleCollision=function(e,t){return;e.coord.x+e.width<t.coord.x||e.coord.x>t.coord.x+t.width||e.coord.y+e.height<t.coord.y||e.coord.y>t.coord.y+t.height};me.core.circleAndPointCollision=function(e,t){return e.radius>Math.sqrt(Math.pow(e.coord.x-t.x,2)+Math.pow(e.coord.y-t.y,2))};me.core.circleAndLineCollision=function(e,t){var n={x:0,y:0};if(t.start.x===t.end.x){n.x=t.start.x;n.y=e.coord.y}else if(t.start.y===t.end.y){n.x=e.coord.x;n.y=t.start.y}else{var r=t.start.x,i=t.start.y,s=t.end.x,o=t.end.y,u=e.coord.x,a=e.coord.y;n.x=(r*Math.pow(o-i,2)+u*Math.pow(s-r,2)+(s-r)*(o-i)*(a-i))/(Math.pow(o-i,2)+Math.pow(s-r,2));n.y=(s-r)*(u-n.x)/(o-i)+a}return e.radius>me.core.distance(e.coord,n)};me.core.circleAndRectangleCollision=function(e,t){return e.coord.x>=t.coord.x-e.radius&&e.coord.x<=t.coord.x+t.width+e.radius&&e.coord.y>=t.coord.y-e.radius&&e.coord.y<=t.coord.y+t.height+e.radius};me.core.isImage=function(e){return Object.prototype.toString.call(e)==="[object HTMLImageElement]"};me.core.isCanvas=function(e){return Object.prototype.toString.call(e)==="[object HTMLCanvasElement]"};me.core.isDrawable=function(e){return me.core.isImage(e)||me.core.isCanvas(e)};me.core.isString=function(e){return typeof e==="string"};me.core.isArray=function(e){if(e===undefined){return false}return!(e.constructor.toString().indexOf("Array")===-1)};me.core.isFunction=function(e){return Object.prototype.toString.call(e)==="[object Function]"}})();(function(){me.input.mX=0;me.input.mY=0;me.input.keys=[];me.input.isPressed=[];me.input.setKeys=function(){me.input.keys["left"]=37;me.input.keys["up"]=38;me.input.keys["right"]=39;me.input.keys["down"]=40;me.input.keys["w"]=87;me.input.keys["a"]=65;me.input.keys["s"]=83;me.input.keys["d"]=68};me.input.mPos=function(e){e=e||window.event;me.input.mX=e.pageX||e.clientX;me.input.mY=e.pageY||e.clientY}})();(function(){me.primitive.point=function(e,t){this.type="point";this.x=e;this.y=t;return this};me.primitive.vector=function(e,t){this.type="vector";this.start=e;this.end=t;return this};me.primitive.circle=function(e,t,n,r){this.type="circle";this.color=r;this.prevcoord=e;this.coord=e;this.radius=t;this.method=n;this.getCoord=function(){return this.coord};this.setCoord=function(e){this.prevcoord=this.coord;this.coord=e};this.setRadius=function(e){this.radius=e};this.draw=function(e){e.clearRect(this.prevcoord.x-this.radius,this.prevcoord.y-this.radius,this.radius*2,this.radius*2);e.clearRect(this.coord.x-this.radius,this.coord.y-this.radius,this.radius*2,this.radius*2);e.beginPath();e.arc(this.coord.x,this.coord.y,this.radius,0,Math.PI*2,true);switch(this.method){case"fill":{e.fillStyle=this.color;e.fill()}break;case"stroke":{e.strokeStyle=this.color;e.stroke()}break}};return this};me.primitive.rectangle=function(e,t,n,r){this.type="rectangle";this.color=n;this.prevcoord=e;this.coord=e;this.width=t.x;this.height=t.y;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.method=r;this.getCoord=function(){return this.coord};this.getSize=function(){return{x:this.width,y:this.height}};this.setCoord=function(e){this.prevcoord=this.coord;this.coord=e};this.setSize=function(e){this.width=e.x;this.height=e.y};this.draw=function(e){e.clearRect(this.prevcoord.x-(this.coord.x-this.prevcoord.x),this.prevcoord.y-(this.coord.y-this.prevcoord.y),this.width,this.height);e.clearRect(this.coord.x,this.coord.y,this.width,this.height);switch(this.method){case"fill":{e.fillStyle=this.color;e.fillRect(this.coord.x,this.coord.y,this.width,this.height)}break;case"stroke":{e.strokeStyle=this.color;e.strokeRect(this.coord.x,this.coord.y,this.width,this.height)}break}};return this};me.primitive.polygon=function(e,t,n,r){this.type="polygon";this.points=t;this.method=r;e.fillStyle=n;e.beginPath();e.moveTo(t[0].x,t[0].y);for(var i=1,s=t.length;i<s;i++){e.lineTo(t[i].x,t[i].y)}e.closePath();switch(this.method){case"fill":{e.fill()}break;case"stroke":{e.stroke()}break}};me.primitive.TextFill=function(){this.draw=function(e,t,n,r,i,s){e.fillStyle=i;e.strokeStyle=s;this.fontSize=Number(t[0]);t[0]+="px";e.font=t.join(" ");e.clearRect(r.x,r.y-this.fontSize,n.toString().length*this.fontSize,this.fontSize);e.fillText(n,r.x,r.y)}};me.primitive.TextStroke=function(){this.draw=function(e,t,n,r,i){e.strokeStyle=i;e.font=aFont;e.strokeText(n,r.x,r.y)}}})();(function(){me.utils.find=function(e){var t=document.querySelectorAll(e);if(t.length===0){throw"Element(s) not found!"}else{return t}};me.utils.log=function(e,t){var n=me.utils.find(["#meLog"]).item(0)||false;if(n){if(n.innerHTML!==""){switch(t){case"m":n.innerHTML+='<span style="color:green;">'+e+"</span><br />\n\r";break;case"w":n.innerHTML+='<span style="color:yellow;">'+e+"</span><br />\n\r";break;case"e":n.innerHTML+='<span style="color:red;">'+e+"</span><br />\n\r";break}}else{switch(t){case"m":n.innerHTML='<span style="color:green;">'+e+"</span><br />\n\r";break;case"w":n.innerHTML='<span style="color:yellow;">'+e+"</span><br />\n\r";break;case"e":n.innerHTML='<span style="color:red;">'+e+"</span><br />\n\r";break}}}};(function(){window.rAF=me.utils.rAF=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}})();me.utils.tFS=function(){if(!!document.fullscreenElement&&!!document.mozFullScreenElement&&!!document.webkitFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen()}else if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen()}else if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}else{if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}}};me.utils.globalize=function(e){var t=e||["find","log","rAF","tFS"];t.forEach(function(e){if(!!window[e]){window[e]=me.utils[e]}else{console.log(e+" already exists in global namespace")}})}})()